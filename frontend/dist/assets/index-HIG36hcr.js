(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();const v="http://localhost:5001/",D=v+"users/",y=v+"assets/",H=D,x=D+"roles/",S=y,O=y,q=y+"assign/",N=y+"unassign/",M=y,R=y,k=y+"request/",P=y+"request/pending/",E={Authorization:`${localStorage.getItem("token")}`,"Content-Type":"application/json"};async function A(e,t){const n=await fetch(e,{headers:t??E}),o=await n.json();return console.log(o,o),o.message=="user not found"&&(localStorage.removeItem("token"),location.href="/src/html/login.html"),[n,o]}async function w(e,t,n){const o=await fetch(e,{headers:n??E,method:"POST",body:JSON.stringify(t)}),s=await o.json();return console.log(s),[o,s]}async function j(e,t,n){const o=await fetch(e,{headers:E,method:"PUT",body:JSON.stringify(t)}),s=await o.json();return[o,s]}async function F(e,t){const n=await fetch(e,{headers:E,method:"DELETE"}),o=await n.json();return[n,o]}async function $(){const e=localStorage.getItem("token");console.log(e);const n=await A(x,{Authorization:e,"Content-Type":"application/json"});return console.log(n),n[1]}function z(){(localStorage.getItem("token")===null||localStorage.getItem("token")===void 0)&&(window.location.href="/src/html/login.html")}function J(e){e.addEventListener("click",()=>{localStorage.clear(),window.location.reload()})}const K=document.getElementById("logout");z();function Y(e){e.includes("Admin")||(document.getElementById("user-nav").style.display="none",document.getElementById("asset-history-nav").style.display="none",document.getElementById("asset-request-nav").style.display="none")}function m(e,...t){for(const n of t)e.appendChild(n);return e}const G=await $();Y(G);let B=[];async function U(){const t=(await A(x))[1];return console.log(t),t.includes("Admin")}let f;async function L(e){let t=document.createElement("select");f=(await A(H))[1],t.setAttribute("name","users"),t.setAttribute("id","users");for(let o=0;o<f.length;o++){const s=document.createElement("option");s.setAttribute("value",f[o].username),s.textContent=f[o].username,t=m(t,s)}e=m(e,t)}async function V(){const e=await A(S);console.log(e),B=e[1],console.log(B),await X(B)}await V();function g(e,t,n){return e.setAttribute("id",t),e.setAttribute("class",n),e}function Q(e,t,n){return e.setAttribute("id",t),e.setAttribute("class",n),e}function b(e,t,n,o,s=!1){let a=document.createElement("td");const i=Q(document.createElement("button"),t,e);return i.type="button",i.textContent=o,i.setAttribute("data-toggle","modal"),i.setAttribute("data-target",n),a=m(a,i),s&&(i.disabled=!0),a}async function W(e){console.log(e);const t=P+`${e.id}`;return(await A(t))[1].message=="Your request is still pending"}async function X(e){let t=document.getElementById("assetTableBody");const n=document.getElementById("createAssets"),o=await U();console.log(e);for(const s of e){let a=document.createElement("tr");const i=document.createElement("td");i.textContent=s.id.toString();const l=document.createElement("td");l.textContent=s.name;const d=document.createElement("td");d.textContent=s.assetType;const u=document.createElement("td");u.textContent="Unassigned";const c=b("btn btn-primary","openButton","#assetModal","Open"),C=c.firstChild;if(C.onclick=()=>le(s),o){const p=b("btn btn-danger","deleteButton","#deleteModal","Delete");p.firstChild.onclick=()=>se(s.id),u.textContent=s.username||"Unassigned",a=m(a,i,l,d,u,c,p)}else{const p=await W(s),r=b("btn btn-secondary","requestButton","#requestModal","Request Asset");s.username?(u.textContent="You",r.textContent="",r.disabled=!0):p?(r.textContent="Pending...",r.disabled=!0):r.firstChild.onclick=()=>me(s.id),a=m(a,i,l,d,u,c,r)}t=m(t,a)}if(o){await Z(n);const s=document.getElementById("requestColumn");s&&s.parentNode.removeChild(s)}else{n&&n.parentNode.removeChild(n);const s=document.getElementById("closeColumn");s&&s.parentNode.removeChild(s)}}async function Z(e){const t=document.createElement("div"),n=document.getElementById("addAssetAssetName");n.textContent="",await L(t),e.setAttribute("data-toggle","modal"),e.setAttribute("data-target","#addAssetModal"),e.onclick=()=>ne(t)}function _(e){const t=document.getElementById("addAssetDropDownForUsers"),n=document.getElementById("addAssetConfigTableBody");n.innerHTML="",t.innerHTML="";let o=!1;if(e.firstChild.childNodes.forEach(a=>{a.value=="noUser"&&(o=!0)}),!o){const a=document.createElement("option");a.selected=!0,a.setAttribute("value","noUser"),a.textContent="No User",e.firstChild.appendChild(a)}t.appendChild(e)}function ee(){const e=document.getElementById("addAssetConfigTableBody");let t=document.createElement("tr");const n=document.createElement("td");n.innerHTML="<input type='text' class='addAssetConfigDetails' required>";const o=document.createElement("td");o.innerHTML="<input type='text' class='addAssetConfigDetails' required>",t=m(t,n,o),e.appendChild(t)}async function te(e){const t=document.getElementsByTagName("input"),n=document.getElementById("assetType");let o={};for(let d=1;d<t.length;d+=2)o[t[d].value]=t[d+1].value;const s=e.firstChild,a=s.value=="noUser"?void 0:s.value,i={name:t[0].value,assetType:n.value,config:o};if(a){const d=h(s.value);i.userId=d.toString()}(await w(O,i))[0].status==201&&window.location.reload()}function ne(e){_(e),document.getElementById("addRowBtn").addEventListener("click",ee);const n=document.getElementById("addAssetBtn");n.onclick=()=>te(e)}async function se(e){const t=R+`${e}`;B=(await F(t))[1],window.location.reload()}function oe(e){let t=g(document.createElement("div"),"","modal-footer");const n=g(document.createElement("button"),"assetAssignBtn","btn btn-primary");n.textContent="Assign";const o=g(document.createElement("button"),"assetEditBtn","btn btn-primary");o.textContent="Edit";const s=g(document.createElement("button"),"assetEditBtn","btn btn-primary");s.textContent="Save";const a=g(document.createElement("button"),"assetUnassignBtn","btn btn-danger");a.textContent="Unassign";const i=document.getElementById("addRowForEdit");return i.innerHTML="",t=m(t,n,a,o),e.username?n.style.display="none":a.style.display="none",o.onclick=()=>re(e,s,t),n.onclick=()=>ce(e.id.toString()),a.onclick=()=>ue(e.id.toString()),t}function ae(){const e=document.getElementById("configTableBody");let t=document.createElement("tr");const n=document.createElement("td");n.innerHTML="<input type='text' class='editAssetConfigDetails' required>";const o=document.createElement("td");o.innerHTML="<input type='text' class='editAssetConfigDetails' required>",t=m(t,n,o),e.appendChild(t)}async function ie(e){const t=document.getElementById("modalAssetId").textContent,n=document.getElementById("editAssetName"),o=document.getElementById("editAssetType"),s=e.getElementsByTagName("input"),a=document.getElementById("modalAssetOwner");let i={};for(let c=0;c<s.length;c+=2)s[c].value.trim().length&&s[c+1].value.trim().length&&(i[s[c].value]=s[c+1].value);let l={name:n.value,assetType:o.value,config:i};if(a.textContent!="Unassigned"){const c=h(a.textContent);l.userId=c.toString()}const d=M+`${t}`;(await j(d,l))[0].status==200&&window.location.reload()}function de(e){const t=e.getElementsByTagName("td");for(let n=0;n<t.length;n++){const o=t[n].textContent;t[n].innerHTML=`<input type='text' class='editAssetConfigDetails' value="${o}">`}}function re(e,t,n){const o=document.getElementById("dropDownForUsers"),s=document.getElementById("addRowForEdit"),a=g(document.createElement("button"),"addRowInEditSection","btn btn-primary"),i=document.getElementById("modalAssetName"),l=document.getElementById("modalAssetType"),d=document.getElementById("configTableBody");o.innerHTML="",n.innerHTML="",n.appendChild(t),t.onclick=()=>ie(d),a.innerHTML="+",a.onclick=()=>ae(),s.appendChild(a),i.innerHTML=`<input type="text" value=${e.name} id="editAssetName" required>`,l.innerHTML=`<select id="editAssetType">
                    <option value="Hardware">Hardware</option>
                    <option value="Software">Software</option>
                </select>`,de(d)}function h(e){for(let t=0;t<f.length;t++)if(f[t].username==e)return f[t].id}async function ce(e){const t=document.getElementById("users").value,n=h(t);(await w(q,{assetId:e,userId:n}))[0].status==201&&window.location.reload()}async function le(e){const t=document.getElementById("assignUnassignCloseBtnBody"),n=document.getElementById("modalAssetId"),o=document.getElementById("modalAssetName"),s=document.getElementById("modalAssetType"),a=document.getElementById("modalAssetOwner"),i=document.getElementById("configTableBody"),l=document.getElementById("dropDownForUsers"),d=g(document.createElement("button"),"close","btn btn-secondary");d.setAttribute("data-dismiss","modal"),d.textContent="Close",l.innerHTML="",n.textContent=e.id.toString(),o.textContent=e.name,s.textContent=e.assetType,a.textContent=e.username||"Unassigned",i.innerHTML="";for(let p in e.config){let r=document.createElement("tr");const I=document.createElement("td");I.textContent=p;const T=document.createElement("td");T.textContent=e.config[p],r=m(r,I,T),i.appendChild(r)}t.innerHTML="";let u=document.createElement("div");if(await U()){const p=oe(e);if(!e.username){const r=document.getElementById("assetAssignToUser");r&&r.parentNode.removeChild(r),await L(l)}u.appendChild(p)}const C=g(document.createElement("div"),"","modal-footer");C.appendChild(d),u.appendChild(C),t.appendChild(u)}async function ue(e){const t=N+`${e}`;await w(t,{}),window.location.reload()}async function me(e){const t={"Content-Type":"application/json",Authorization:`${localStorage.getItem("token")}`},n=await w(k,{assetId:e},t);if(!n[0].ok){alert(n[1].message);return}alert("Asset request created successfully"),window.location.reload()}J(K);
